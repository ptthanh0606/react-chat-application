(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[5],{318:function(e,t,n){},327:function(e,t,n){"use strict";n.r(t);var c=n(0),a=n.n(c),i=n(14),r=n(5),s=n(31),o=n.n(s),l=n(18),u=n(33),d=n(19),j=n(34),b=n(325),m=n(1),f=function(e){var t=e.content,n=void 0===t?"":t,c=e.fromName,s=void 0===c?"":c,o=e.variant,l=void 0===o?"primary":o,u=e.noRadius,d=void 0===u?"":u,f=Object(j.a)(e,["content","fromName","variant","noRadius"]),O=a.a.useState({}),x=Object(r.a)(O,2),h=x[0],p=x[1];return a.a.useEffect((function(){switch(d){case"top-left":p({borderRadius:"5px 20px 20px 20px"});break;case"top-right":p({borderRadius:"20px 5px 20px 20px"});break;case"bottom-right":p({borderRadius:"20px 20px 5px 20px"});break;case"bottom-left":p({borderRadius:"20px 20px 20px 5px"});break;case"right":p({borderRadius:"20px 5px 5px 20px"});break;case"left":p({borderRadius:"5px 20px 20px 5px"});break;case"last":p({borderRadius:"5px 5px 20px 20px"});break;default:p({borderRadius:"20px 20px 20px 20px"})}}),[d]),Object(m.jsxs)("h5",Object(i.a)(Object(i.a)({},f),{},{children:[s&&Object(m.jsx)("span",{className:"text-muted font-weight-normal mt-1 ml-2 mb-1",style:{fontSize:"13px"},children:s}),Object(m.jsx)(b.a,{style:Object(i.a)({padding:".7rem .7rem"},h),pill:!0,className:"font-weight-normal",variant:l,children:n})]}))},O=a.a.memo(f),x=n(20),h=n(127),p=n(328),v=n(324),g=n(320),k=n(30),y=n(288),C=Object(y.io)(k.a),N=function(e){var t=e.setMessages,n=void 0===t?function(){}:t,c=Object(j.a)(e,["setMessages"]),r=Object(l.c)(d.b).uuid,s=Object(l.c)(u.b).conversationId,b=a.a.useCallback((function(e,t){var c=e.chatContent,a=t.resetForm;c&&(n((function(e){return[].concat(Object(x.a)(e),[{content:c,nickname:r}])})),o.a.put(Object(k.g)(s),{content:c,uuid:r}).then((function(){C.emit("CLIENT_MESSAGE_SEND",{content:c,uuid:r}),a()})))}),[s,n,r]),f=Object(h.a)({initialValues:{chatContent:""},onSubmit:b});return Object(m.jsx)(p.a,Object(i.a)(Object(i.a)({},c),{},{onSubmit:f.handleSubmit,children:Object(m.jsxs)(p.a.Group,{className:"d-flex align-items-center my-3",children:[Object(m.jsx)(p.a.Control,{id:"chatContent",name:"chatContent",autoFocus:!0,placeholder:"Type a message...",onChange:f.handleChange,value:f.values.chatContent}),Object(m.jsx)(v.a,{className:"p-0 mx-3 mb-1",variant:"link",size:"lg",style:{fontSize:"1.5rem"},children:Object(m.jsx)(g.a,{})})]})}))},w=a.a.memo(N),E=n(323);function S(){return(S=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var c in n)Object.prototype.hasOwnProperty.call(n,c)&&(e[c]=n[c])}return e}).apply(this,arguments)}function I(e,t){if(null==e)return{};var n,c,a=function(e,t){if(null==e)return{};var n,c,a={},i=Object.keys(e);for(c=0;c<i.length;c++)n=i[c],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(c=0;c<i.length;c++)n=i[c],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var F=c.createElement("defs",null,c.createElement("style",null,".cls-1{fill:#007BFF;}.cls-2{fill:#fff;}")),R=c.createElement("g",{id:"Layer_2","data-name":"Layer 2"},c.createElement("g",{id:"Middle_ground","data-name":"Middle ground"},c.createElement("polygon",{className:"cls-1",points:"101 62.75 86 49.5 101.3 49.5 101 62.75"}),c.createElement("rect",{className:"cls-1",width:116,height:51,rx:20.68,ry:20.68,transform:"translate(116 51) rotate(-180)"}),c.createElement("circle",{className:"cls-2",cx:73.5,cy:25.5,r:4.5}),c.createElement("circle",{className:"cls-2",cx:58,cy:25.5,r:4.5}),c.createElement("circle",{className:"cls-2",cx:42.5,cy:25.5,r:4.5})));function _(e,t){var n=e.title,a=e.titleId,i=I(e,["title","titleId"]);return c.createElement("svg",S({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 116 62.75",ref:t,"aria-labelledby":a},i),F,void 0===n?c.createElement("title",{id:a},"typing-modal"):n?c.createElement("title",{id:a},n):null,R)}var P=c.forwardRef(_),M=(n.p,function(){return Object(m.jsxs)(E.a,{className:"h-100 d-flex flex-column align-items-center justify-content-center",children:[Object(m.jsx)(P,{height:"50px"}),"Select a conversation to start"]})}),A=a.a.memo(M),G=function(e){var t=Object.assign({},e),n=Object(l.c)(u.b).conversationId,c=Object(l.c)(d.b).uuid,s=a.a.useState(null),j=Object(r.a)(s,2),b=j[0],f=j[1],x=a.a.useReducer((function(){return{}})),h=Object(r.a)(x,2),p=h[0],v=h[1],g=a.a.useRef();return a.a.useEffect((function(){n?o.a.get(Object(k.e)(n,c)).then((function(e){f(e.data.data)})).catch((function(e){console.log(e)})):console.log("no conversion id")}),[n,c,p]),a.a.useEffect((function(){C.on("MESSAGE_INCOMMING",(function(){v(),g.current.scrollIntoView({behavior:"smooth",block:"end",inline:"nearest"})}))}),[]),a.a.useEffect((function(){setTimeout((function(){g.current.scrollIntoView({behavior:"smooth",block:"end",inline:"nearest"})}),100)}),[b,n]),Object(m.jsxs)("div",Object(i.a)(Object(i.a)({},t),{},{children:[Object(m.jsx)("div",{className:"flex-grow-1 pl-3 pr-3 d-flex flex-column",style:{overflowY:"scroll"},children:Object(m.jsx)("div",{className:"d-flex flex-column justify-content-end",ref:g,children:b?b.length&&b.map((function(e,t){var n,a,i,r,s,o,l,u,d;return Object(m.jsx)(O,{className:"d-flex flex-column align-items-".concat(e.nickname===c?"end":"start"," ").concat(e.nickname===(null===(n=b[t+1])||void 0===n?void 0:n.nickname)||e.nickname===(null===(a=b[t-1])||void 0===a?void 0:a.nickname)?"":"my-2"),style:{margin:"1px 0"},noRadius:e.nickname===c?e.nickname===(null===(i=b[t+1])||void 0===i?void 0:i.nickname)?e.nickname===(null===(r=b[t-1])||void 0===r?void 0:r.nickname)?"right":"bottom-right":e.nickname!==(null===(s=b[t-1])||void 0===s?void 0:s.nickname)?"single":"top-right":e.nickname===(null===(o=b[t+1])||void 0===o?void 0:o.nickname)?e.nickname===(null===(l=b[t-1])||void 0===l?void 0:l.nickname)?"left":"bottom-left":e.nickname!==(null===(u=b[t-1])||void 0===u?void 0:u.nickname)?"single":"top-left",content:e.content,variant:e.nickname===c?"primary":"secondary",fromName:e.nickname===((null===(d=b[t-1])||void 0===d?void 0:d.nickname)||e.nickname===c)||e.nickname===c?null:Object(m.jsx)("span",{children:e.nickname})})}))||Object(m.jsx)("div",{className:"mt-2 text-muted",children:Object(m.jsx)("i",{children:"Start by sending a message."})}):null})}),n?Object(m.jsx)(w,{setMessages:f,className:"pl-3"}):Object(m.jsx)(A,{})]}))},H=a.a.memo(G),L=n(330),B=n(329),D=n(326),K=n(331),V=n(35),z=function(e){var t=e.nickname,n=void 0===t?" ":t,c=Object(j.a)(e,["nickname"]);return Object(m.jsx)(K.a.Item,Object(i.a)(Object(i.a)({},c),{},{children:n}))},T=a.a.memo(z),q=function(){var e=a.a.useState([]),t=Object(r.a)(e,2),n=t[0],c=t[1],i=Object(l.c)(d.b),s=Object(l.c)(V.b);return a.a.useEffect((function(){o.a.get(Object(k.c)(i.uuid)).then((function(e){e.data.data&&c(function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).map((function(e,t){return{uuid:e.uuid||console.log("uuid field not existed!"),nickname:e.nickname||console.log("nickname field is not existed!"),isActive:!1}}))}(e.data.data.savedPeople))})).catch((function(e){console.error(e.message)}))}),[c,i.uuid,s]),Object(m.jsx)(K.a,{variant:"flush",children:n&&n.length&&n.map((function(e,t){return Object(m.jsx)(T,{nickname:e.nickname},t)}))||Object(m.jsx)("div",{className:"px-3 py-2",children:Object(m.jsx)("span",{className:"text-muted small",children:"No contacts vailable"})})})},J=a.a.memo(q),U=(n(318),function(){var e=a.a.useState([]),t=Object(r.a)(e,2),n=t[0],c=t[1],s=Object(l.b)(),j=Object(l.c)(d.b),b=Object(l.c)(u.b).conversationId,f=a.a.useCallback((function(e){s(Object(u.c)(e))}),[s]);return a.a.useEffect((function(){o.a.get(Object(k.d)(j.uuid)).then((function(e){c((function(){return(t=e.data.data,n=j.uuid,t.map((function(e,t){return Object(i.a)(Object(i.a)({},e),{},{recipients:e.recipients.filter((function(e){return e!==n})),isActive:0===t})}))).map((function(e){return e._id===b?Object(i.a)(Object(i.a)({},e),{},{isActive:!0}):Object(i.a)(Object(i.a)({},e),{},{isActive:!1})}));var t,n}))})).catch((function(e){console.log(e)}))}),[b,s,j.uuid]),a.a.useEffect((function(){C.emit("OPEN_CONVERSATION",{conversationId:b})}),[b]),Object(m.jsx)(K.a,{variant:"flush",children:n&&n.length&&n.map((function(e,t){return Object(m.jsx)(K.a.Item,{className:"ConversationItem",active:e.isActive,style:{cursor:"pointer"},onClick:function(){return f(e._id)},children:e.recipients.map((function(t){return e.recipients.indexOf(t)===e.recipients.length-1?Object(m.jsx)(m.Fragment,{children:t}):Object(m.jsxs)(m.Fragment,{children:[t,", "]})}))},t)}))||Object(m.jsx)("div",{className:"px-3 py-2",children:Object(m.jsx)("span",{className:"text-muted small",children:"Currently quiet here..."})})})}),Y=a.a.memo(U),Q=n(36),W=n(177),X=W.a().shape({userid:W.b().required(),username:W.b().required()}),Z=function(e){var t=e.onHide,n=void 0===t?function(){}:t,c=Object(l.c)(d.b).uuid,i=Object(l.b)(),r=a.a.useCallback((function(e){o.a.put(Object(k.b)(c),{uuid:e.userid,nickname:e.username}).then((function(){i(Object(V.c)()),n()})).catch((function(e){Q.b.error(e.response.data),n()}))}),[i,n,c]),s=Object(h.a)({initialValues:{userid:"",username:""},onSubmit:r,validationSchema:X});return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(D.a.Header,{closeButton:!0,children:"New contact"}),Object(m.jsx)(D.a.Body,{children:Object(m.jsxs)(p.a,{onSubmit:s.handleSubmit,id:"newContactForm",children:[Object(m.jsxs)(p.a.Group,{children:[Object(m.jsx)(p.a.Label,{children:"ID"}),Object(m.jsx)(p.a.Control,{type:"text",id:"userid",name:"userid",onChange:s.handleChange,value:s.values.userid,isInvalid:s.errors.userid}),Object(m.jsx)(p.a.Control.Feedback,{type:"invalid",children:"Please provide an ID"})]}),Object(m.jsxs)(p.a.Group,{children:[Object(m.jsx)(p.a.Label,{children:"Recognize name"}),Object(m.jsx)(p.a.Control,{type:"text",id:"username",name:"username",onChange:s.handleChange,value:s.values.username,isInvalid:s.errors.username}),Object(m.jsx)(p.a.Control.Feedback,{type:"invalid",children:"Please provide a name for this contact"})]})]})}),Object(m.jsxs)(D.a.Footer,{children:[Object(m.jsx)(v.a,{type:"submit",form:"newContactForm",children:"Confirm"}),Object(m.jsx)(v.a,{variant:"outline-secondary",onClick:n,children:"Close"})]})]})},$=a.a.memo(Z),ee=function(e){var t=e.onHide,n=void 0===t?function(){}:t,c=Object(l.b)(),i=Object(l.c)(d.b),s=a.a.useState([]),j=Object(r.a)(s,2),b=j[0],f=j[1],O=a.a.useState([]),h=Object(r.a)(O,2),g=h[0],y=h[1],C=a.a.useCallback((function(e){e.preventDefault(),o.a.post(Object(k.h)(i.uuid),b).then((function(e){c(Object(u.c)(e.data.data._id)),n()})).catch((function(e){Q.b.error(e)}))}),[i.uuid,c,n,b]),N=a.a.useCallback((function(e){f((function(t){return t.includes(e)?t.filter((function(t){return t!==e})):[].concat(Object(x.a)(t),[e])}))}),[]);return a.a.useEffect((function(){o.a.get(Object(k.c)(i.uuid)).then((function(e){y(e.data.data.savedPeople)})).catch((function(e){}))}),[i.uuid]),Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(D.a.Header,{closeButton:!0,children:"New contact"}),Object(m.jsx)(D.a.Body,{children:Object(m.jsx)(p.a,{onSubmit:C,id:"newContactForm",children:g&&g.length&&g.map((function(e){return Object(m.jsx)(p.a.Group,{children:Object(m.jsx)(p.a.Check,{label:e.nickname,name:"contactId",value:b.includes(e.uuid),onChange:function(){return N(e.uuid)}})},e.uuid)}))||Object(m.jsx)("span",{className:"text-muted",children:"No contacts available!"})})}),Object(m.jsxs)(D.a.Footer,{children:[Object(m.jsx)(v.a,{type:"submit",form:"newContactForm",children:"Start Conversation"}),Object(m.jsx)(v.a,{variant:"outline-secondary",onClick:n,children:"Close"})]})]})},te=a.a.memo(ee),ne="conver_key",ce="contact_key",ae=function(e){var t=Object.assign({},e),n=a.a.useState(ne),c=Object(r.a)(n,2),s=c[0],o=c[1],u=a.a.useState(!1),j=Object(r.a)(u,2),b=j[0],f=j[1],O=s===ne,x=Object(l.c)(d.b),h=a.a.useCallback((function(){f(!0)}),[]);return Object(m.jsxs)("div",Object(i.a)(Object(i.a)({},t),{},{children:[Object(m.jsxs)(L.a.Container,{activeKey:s,onSelect:o,children:[Object(m.jsxs)(B.a,{variant:"tabs",children:[Object(m.jsx)(B.a.Item,{children:Object(m.jsx)(B.a.Link,{eventKey:ne,children:"Conversations"})}),Object(m.jsx)(B.a.Item,{children:Object(m.jsx)(B.a.Link,{eventKey:ce,children:"Contacts"})})]}),Object(m.jsxs)(L.a.Content,{className:"border-right overflow-auto flex-grow-1",children:[Object(m.jsx)(L.a.Pane,{eventKey:ne,children:Object(m.jsx)(Y,{})}),Object(m.jsx)(L.a.Pane,{eventKey:ce,children:Object(m.jsx)(J,{})})]}),Object(m.jsxs)("div",{className:"p-2 border-top border-right small",children:["UUID ",Object(m.jsx)("span",{className:"text-muted",children:x.uuid})]}),Object(m.jsxs)(v.a,{className:"rounded-0",onClick:h,children:["New ",O?"Conversation":"Contact"]})]}),Object(m.jsx)(D.a,{show:b,onHide:function(){return f(!1)},children:O?Object(m.jsx)(te,{onHide:function(){return f(!1)}}):Object(m.jsx)($,{onHide:function(){return f(!1)}})})]}))},ie=a.a.memo(ae),re=function(){return a.a.useEffect((function(){return function(){return C.disconnect()}}),[]),Object(m.jsx)("div",{className:"container-fluid",style:{height:"100vh"},children:Object(m.jsxs)("div",{className:"row h-100",children:[Object(m.jsx)(ie,{className:"col-xl-3 col-md-4 col-sm-5 pl-0 pr-0 d-flex flex-column h-100"}),Object(m.jsx)(H,{className:"col-xl-9 col-md-8 col-sm-7 pl-0 pr-0 d-flex flex-column h-100"})]})})};t.default=a.a.memo(re)}}]);
//# sourceMappingURL=5.5cde25d3.chunk.js.map